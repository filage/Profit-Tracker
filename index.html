<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ—Ç –ø–æ–∫—É–ø–æ–∫ –∏ –ø—Ä–æ–¥–∞–∂</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>–¢—Ä–µ–∫–µ—Ä –ü—Ä–∏–±—ã–ª–∏</h1>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="graph">
                <span class="tab-icon">üìä</span> –ì—Ä–∞—Ñ–∏–∫
            </button>
            <button class="nav-tab" data-tab="calendar">
                <span class="tab-icon">üìÖ</span> –ö–∞–ª–µ–Ω–¥–∞—Ä—å
            </button>
            <button class="nav-tab" data-tab="rate">
                <span class="tab-icon">üí±</span> –ö—É—Ä—Å —é–∞–Ω—è
            </button>
        </nav>

        <!-- –°–µ–∫—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ -->
        <section id="graph" class="tab-content active">
            <!-- –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–±—ã–ª–∏ -->
            <div class="chart-section">
                <div class="chart-controls">
                    <div class="chart-buttons">
                        <button class="chart-btn" id="togglePointsBtn">‚ö´ –¢–û–ß–ö–ò</button>
                    </div>
                    <div class="period-filter">
                        <label>–ü–µ—Ä–∏–æ–¥:</label>
                        <div class="quick-period-btns">
                            <button class="quick-period-btn" data-period="week">–ù–µ–¥–µ–ª—è</button>
                            <button class="quick-period-btn active" data-period="month">–ú–µ—Å—è—Ü</button>
                            <button class="quick-period-btn" data-period="year">–ì–æ–¥</button>
                        </div>
                        <input type="date" id="dateFrom">
                        <span>‚Äî</span>
                        <input type="date" id="dateTo">
                        <button id="resetDatesBtn" class="btn-small">–°–±—Ä–æ—Å</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="profitChart"></canvas>
                </div>
            </div>

            <div class="controls">
                <div class="control-row">
                    <div class="item-selector">
                        <label>–¢–∏–ø –≤–µ—â–∏:</label>
                        <select id="itemTypeFilter">
                            <option value="all">–í—Å–µ</option>
                        </select>
                        <button id="manageItemsBtn" class="btn-icon" title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞–º–∏">‚öôÔ∏è</button>
                    </div>
                    <div class="equalize-toggle">
                        <span>–ü—Ä–∏—Ä–∞–≤–Ω—è—Ç—å –ø–æ–∫—É–ø–∫–∏ –∫ –ø—Ä–æ–¥–∞–∂–∞–º</span>
                        <label class="switch">
                            <input type="checkbox" id="equalizeToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="controls filter-row">
                <div class="control-row">
                    <div class="data-buttons">
                        <button id="exportBtn" class="btn-small btn-export">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
                        <button id="importBtn" class="btn-small btn-import">üì• –ò–º–ø–æ—Ä—Ç</button>
                        <input type="file" id="importFile" accept=".json" style="display:none">
                    </div>
                </div>
            </div>

            <div class="stats-cards">
                <div class="stat-card income">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-info">
                        <h3>–î–û–•–û–î</h3>
                        <p class="amount" id="totalIncome">0 ‚ÇΩ</p>
                        <p class="quantity">–ü—Ä–æ–¥–∞–Ω–æ: <span id="totalSold">0</span> —à—Ç.</p>
                    </div>
                </div>
                <div class="stat-card expense">
                    <div class="stat-icon">üí∏</div>
                    <div class="stat-info">
                        <h3>–†–ê–°–•–û–î</h3>
                        <p class="amount" id="totalExpense">0 ‚ÇΩ</p>
                        <p class="quantity">–ö—É–ø–ª–µ–Ω–æ: <span id="totalBought">0</span> —à—Ç.</p>
                    </div>
                </div>
            </div>

            <div class="profit-display">
                <div class="profit-label">–ß–ò–°–¢–ê–Ø –ü–†–ò–ë–´–õ–¨</div>
                <div class="profit-amount" id="totalProfit">0 ‚ÇΩ</div>
            </div>

            <div class="item-stats" id="itemStats">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–∏–ø—É –≤–µ—â–µ–π -->
            </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è -->
        <section id="calendar" class="tab-content">
            <div class="calendar-header">
                <button id="prevMonth" class="btn-nav">‚óÄ</button>
                <h2 id="currentMonth"></h2>
                <button id="nextMonth" class="btn-nav">‚ñ∂</button>
            </div>
            <div class="calendar-grid" id="calendarGrid">
                <div class="weekday">–ü–Ω</div>
                <div class="weekday">–í—Ç</div>
                <div class="weekday">–°—Ä</div>
                <div class="weekday">–ß—Ç</div>
                <div class="weekday">–ü—Ç</div>
                <div class="weekday">–°–±</div>
                <div class="weekday">–í—Å</div>
            </div>
            <div id="dayDetails" class="day-details hidden">
                <div class="day-details-header">
                    <h3>–î–µ—Ç–∞–ª–∏ –¥–Ω—è: <span id="selectedDate"></span></h3>
                    <button class="close-day-details" id="closeDayDetails">‚úï</button>
                </div>
                <p class="day-rate-info">–ö—É—Ä—Å —é–∞–Ω—è: <span id="dayRate">‚Äî</span></p>
                <div id="dayTransactions"></div>
            </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è –∫—É—Ä—Å–∞ —é–∞–Ω—è -->
        <section id="rate" class="tab-content">
            <h2>–ö—É—Ä—Å —é–∞–Ω—è –∫ —Ä—É–±–ª—é</h2>
            <div class="rate-form">
                <div class="form-group">
                    <label>–ö—É—Ä—Å (1 —é–∞–Ω—å = X —Ä—É–±–ª–µ–π):</label>
                    <input type="number" id="rateValue" step="0.01" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 12.5">
                </div>
                <div class="form-group">
                    <label>–î–∞—Ç–∞:</label>
                    <input type="date" id="rateDate">
                </div>
                <button id="saveRateBtn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫—É—Ä—Å</button>
            </div>
            <div class="rate-history">
                <h3>–ò—Å—Ç–æ—Ä–∏—è –∫—É—Ä—Å–æ–≤</h3>
                <div id="rateList"></div>
            </div>
        </section>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
        <div class="action-buttons">
            <button id="addSaleBtn" class="btn-action btn-income">+ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥–∞–∂—É</button>
            <button id="addPurchaseBtn" class="btn-action btn-expense">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∫—É–ø–∫—É</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ -->
    <div id="purchaseModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>–î–û–ë–ê–í–ò–¢–¨ –ü–û–ö–£–ü–ö–£</h2>
            <form id="purchaseForm">
                <div class="form-group">
                    <label>–¢–∏–ø –≤–µ—â–∏:</label>
                    <select id="purchaseItemType" required></select>
                </div>
                <div class="form-group">
                    <label>–î–∞—Ç–∞:</label>
                    <input type="date" id="purchaseDate" required>
                </div>
                <div class="form-group">
                    <label>–í–∞–ª—é—Ç–∞:</label>
                    <select id="purchaseCurrency">
                        <option value="RUB">–†—É–±–ª–∏ (‚ÇΩ)</option>
                        <option value="CNY">–Æ–∞–Ω–∏ (¬•)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                    <input type="number" id="purchaseQuantity" min="1" required>
                </div>
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ –∑–∞ 1 —à—Ç.:</label>
                    <input type="number" step="0.01" id="purchaseAmount" required>
                </div>
                <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂–∏ -->
    <div id="saleModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>–î–û–ë–ê–í–ò–¢–¨ –ü–†–û–î–ê–ñ–£</h2>
            <form id="saleForm">
                <div class="form-group">
                    <label>–¢–∏–ø –≤–µ—â–∏:</label>
                    <select id="saleItemType" required></select>
                </div>
                <div class="form-group">
                    <label>–î–∞—Ç–∞:</label>
                    <input type="date" id="saleDate" required>
                </div>
                <div class="form-group">
                    <label>–í–∞–ª—é—Ç–∞:</label>
                    <select id="saleCurrency">
                        <option value="RUB">–†—É–±–ª–∏ (‚ÇΩ)</option>
                        <option value="CNY">–Æ–∞–Ω–∏ (¬•)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                    <input type="number" id="saleQuantity" min="1" required>
                </div>
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ –∑–∞ 1 —à—Ç.:</label>
                    <input type="number" step="0.01" id="saleAmount" required>
                </div>
                <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∏–ø–∞–º–∏ –≤–µ—â–µ–π -->
    <div id="itemsModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞–º–∏ –≤–µ—â–µ–π</h2>
            <div class="form-group">
                <label>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø:</label>
                <div class="add-item-row">
                    <input type="text" id="newItemName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
                    <button id="addItemTypeBtn" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
            <div class="items-list" id="itemTypesList"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–∏–ø–∞ -->
    <div id="editItemModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø –≤–µ—â–∏</h2>
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" id="editItemName">
                <input type="hidden" id="editItemIndex">
            </div>
            <button id="saveItemEditBtn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ -->
    <div id="detailsModal" class="modal hidden">
        <div class="modal-content modal-wide">
            <span class="close-modal">&times;</span>
            <h2 id="detailsTitle">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</h2>
            <div class="details-summary" id="detailsSummary"></div>
            <div class="details-list" id="detailsList"></div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
    <div id="editTxModal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</h2>
            <div class="form-group">
                <label>–¢–∏–ø –≤–µ—â–∏:</label>
                <select id="editTxItemType"></select>
            </div>
            <div class="form-group">
                <label>–î–∞—Ç–∞:</label>
                <input type="date" id="editTxDateInput">
            </div>
            <div class="form-group">
                <label>–í–∞–ª—é—Ç–∞:</label>
                <select id="editTxCurrency">
                    <option value="RUB">–†—É–±–ª–∏ (‚ÇΩ)</option>
                    <option value="CNY">–Æ–∞–Ω–∏ (¬•)</option>
                </select>
            </div>
            <div class="form-group">
                <label>–¶–µ–Ω–∞ –∑–∞ 1 —à—Ç.:</label>
                <input type="number" step="0.01" id="editTxAmount" required>
            </div>
            <div class="form-group">
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                <input type="number" id="editTxQuantity" min="1" required>
            </div>
            <input type="hidden" id="editTxId">
            <input type="hidden" id="editTxType">
            <input type="hidden" id="editTxContext">
            <input type="hidden" id="editTxDate">
            <button id="saveEditTxBtn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
